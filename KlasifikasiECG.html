
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Klasifikasi Sinyal Elektrokardiogram (ECG) pada Dataset ECG5000 &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'KlasifikasiECG';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Ekstraksi Fitur Audio dengan 3 Domain" href="EkstraksiAudio.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/foprib.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/foprib.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to My Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="BusinessUnderstanding.html"><strong>Business Understanding</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="DataUnderstanding.html"><strong>Data Understanding</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="PreProcessing.html"><strong>Analisis IRIS di Power BI</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Oversampling.html"><strong>Oversampling Data</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="TimeSeries.html"><strong>Time Series</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="EkstraksiAudio.html"><strong>Ekstraksi Fitur Audio dengan 3 Domain</strong></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>Klasifikasi Sinyal Elektrokardiogram (ECG) pada Dataset ECG5000</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FKlasifikasiECG.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/KlasifikasiECG.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Klasifikasi Sinyal Elektrokardiogram (ECG) pada Dataset ECG5000</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bussines-understanding"><strong>Bussines Understanding</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tujuan-analisis"><strong>Tujuan Analisis</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-data-eda"><strong>Understanding Data (EDA)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-dataset"><strong>Load Dataset</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ukuran-dataset"><strong>Ukuran Dataset</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cek-missing-value"><strong>Cek Missing Value</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distribusi-kelas-imbalance"><strong>Distribusi Kelas (Imbalance)</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-contoh-sinyal-per-kelas"><strong>Plot Contoh Sinyal per Kelas</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-processing"><strong>Pre Processing</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#normalisasi-data-menggunakan-min-max-scalling"><strong>Normalisasi Data menggunakan Min-Max Scalling</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#split-data-dan-menyeimbangkan-data-dengan-smote"><strong>Split Data dan Menyeimbangkan Data dengan SMOTE</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelling-data"><strong>Modelling Data</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forest"><strong>Random Forest</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-cnn"><strong>1D CNN</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluasi"><strong>Evaluasi</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#table-comparison"><strong>Table Comparison</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#confusion-matrix"><strong>Confusion Matrix</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisasi-prediksi-sinyal"><strong>Visualisasi Prediksi Sinyal</strong></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="klasifikasi-sinyal-elektrokardiogram-ecg-pada-dataset-ecg5000">
<h1><strong>Klasifikasi Sinyal Elektrokardiogram (ECG) pada Dataset ECG5000</strong><a class="headerlink" href="#klasifikasi-sinyal-elektrokardiogram-ecg-pada-dataset-ecg5000" title="Link to this heading">#</a></h1>
<section id="bussines-understanding">
<h2><strong>Bussines Understanding</strong><a class="headerlink" href="#bussines-understanding" title="Link to this heading">#</a></h2>
<p>Pemeriksaan Electrocardiogram (ECG) merupakan metode utama untuk mendeteksi gangguan irama dan aktivitas jantung. Dalam praktik klinis, jumlah rekaman sinyal ECG bisa sangat banyak dan membutuhkan analisis yang cepat dan akurat. Proses analisis manual oleh tenaga medis memakan waktu, sehingga diperlukan sistem yang mampu mengklasifikasikan pola sinyal ECG secara otomatis.</p>
<p>Dataset ECG5000 menyediakan data time-series detak jantung yang terdiri dari lima jenis pola:</p>
<ul class="simple">
<li><p>Normal</p></li>
<li><p>R-on-T Premature Ventricular Contraction (R-On-T PVC)</p></li>
<li><p>Premature Ventricular Contraction (PVC)</p></li>
<li><p>Supraventricular Premature Beat</p></li>
<li><p>Unclassified Beat</p></li>
</ul>
<p><strong>Identifikasi Sumber Data dan Infrastruktur</strong></p>
<p>Data ini bersumber dari ekosistem PhysioNet, sebuah inisiatif kolaborasi penelitian yang memiliki tiga komponen utama yang saling terkait:</p>
<ul class="simple">
<li><p>PhysioBank: Berperan sebagai arsip digital skala besar yang menyimpan rekaman sinyal fisiologis terkarakterisasi, termasuk basis data sinyal kardiopulmoner dari pasien dengan kondisi gagal jantung kongestif (congestive heart failure).</p></li>
<li><p>PhysioToolkit: Menyediakan pustaka perangkat lunak open-source untuk pemrosesan sinyal dan deteksi peristiwa fisiologis penting, yang memungkinkan pembuatan basis data baru dari rekaman mentah.</p></li>
<li><p>PhysioNet: Berfungsi sebagai forum online untuk diseminasi, pertukaran data, dan evaluasi algoritma baru bagi komunitas biomedis.</p></li>
</ul>
<p>Paper sumber data asli: <em>PhysioBank, PhysioToolkit, and PhysioNet : Components of a New Research Resource for Complex Physiologic Signals</em></p>
<p>Paper pertama pengguna ecg5000: <a class="reference external" href="http://alumni.cs.ucr.edu/~ychen053/NEL_Journal.pdf">http://alumni.cs.ucr.edu/~ychen053/NEL_Journal.pdf</a></p>
<section id="tujuan-analisis">
<h3><strong>Tujuan Analisis</strong><a class="headerlink" href="#tujuan-analisis" title="Link to this heading">#</a></h3>
<p>Tujuan dari proyek ini adalah untuk membangun model klasifikasi yang mampu mengidentifikasi jenis pola sinyal ECG berdasarkan data time-series dari dataset ECG5000. Model yang dibuat diharapkan dapat:</p>
<ul class="simple">
<li><p>Membedakan sinyal ECG normal dan tidak normal.</p></li>
<li><p>Memprediksi jenis kelainan detak jantung berdasarkan pola sinyal</p></li>
<li><p>Membandingkan beberapa model klasifikasi misal knn-dtw, random forest, dan Svm</p></li>
</ul>
</section>
</section>
<section id="understanding-data-eda">
<h2><strong>Understanding Data (EDA)</strong><a class="headerlink" href="#understanding-data-eda" title="Link to this heading">#</a></h2>
<p>ECG5000 adalah dataset time-series yang berisi sinyal Electrocardiogram (ECG) dari berbagai pasien. Setiap data merupakan satu siklus detak jantung yang telah dinormalisasi dan dipotong menjadi panjang yang sama.</p>
<p>Dataset ini berasal dari Beth Israel Deaconess Medical Center dan merupakan bagian dari PhysioNet / UCR Time Series Classification Archive. Dataset ini juga terdiri dari 500 data train dan 4500 data test, 140 fitur → nilai amplitudo sinyal ECG pada setiap time-step dan 1 label kelas (di kolom terakhir)</p>
<p><strong>Proses Akuisisi Data</strong></p>
<p>Dataset ECG5000 diolah dari rekaman asli berdurasi 20 jam yang berasal dari pasien pria berusia 48 tahun dengan kondisi gagal jantung kongestif berat (BIDMC Congestive Heart Failure Database, rekaman chf07). Rekaman mentah tersebut awalnya memiliki 17.998.834 titik data yang mencakup total 92.584 detak jantung</p>
<p>Untuk memahami bagaimana rekaman kontinu selama 20 jam bisa berubah menjadi baris-baris data time series (140 kolom), Berikut adalah alur teknis perubahannya:</p>
<ol class="arabic simple">
<li><p>Sinyal Kontinu (Raw Data)
Awalnya, data adalah satu aliran listrik jantung yang sangat panjang dari rekaman chf07. Jika divisualisasikan, ini seperti benang panjang yang tidak putus selama 20 jam. Frekuensi pengambilan sampelnya tinggi (misal 250 atau 128 sampel per detik).</p></li>
<li><p>Deteksi Puncak R (R-Peak Detection)
Peneliti menggunakan algoritma (seperti Pan-Tompkins) untuk mencari titik Puncak R (gelombang tertinggi pada detak jantung). Puncak R ini digunakan sebagai “jangkar” atau titik pusat untuk memotong sinyal.</p></li>
<li><p>Pemotongan (Segmentation/Windowing)
Setelah puncak R ditemukan, peneliti memotong area di sekitar puncak tersebut. Misalnya:</p>
<ul class="simple">
<li><p>Mengambil sekian milidetik sebelum puncak (untuk mendapatkan gelombang P).</p></li>
<li><p>Mengambil sekian milidetik sesudah puncak (untuk mendapatkan gelombang T).</p></li>
<li><p>Hasilnya: Satu aliran panjang tadi sekarang terpotong-potong menjadi ribuan potongan kecil detak jantung individu.</p></li>
</ul>
</li>
<li><p>Masalah: Kecepatan Jantung Berbeda (Heart Rate Variability)
Di sinilah letak kesulitan utamanya. Jantung manusia tidak berdetak seperti jam; kadang cepat, kadang lambat.</p>
<ul class="simple">
<li><p>Jika jantung berdetak cepat, satu detak mungkin hanya butuh 100 titik data.</p></li>
<li><p>Jika jantung berdetak lambat, satu detak mungkin butuh 180 titik data.</p></li>
<li><p>Masalah: Komputer (model CNN/RF) membutuhkan jumlah kolom yang sama persis (konsisten).</p></li>
</ul>
</li>
<li><p>Solusi: Interpolasi Sinc (Resampling ke 140 Titik)
Untuk menyamakan panjangnya, peneliti melakukan Interpolasi.</p>
<ul class="simple">
<li><p>Semua potongan detak jantung yang panjangnya berbeda-beda tadi “dipaksa” atau diregangkan/disusutkan secara matematis agar semuanya memiliki panjang tepat 140 titik data.</p></li>
<li><p>Angka 140 dipilih karena dianggap cukup untuk mewakili morfologi (bentuk) gelombang P-QRS-T secara detail tanpa membuat ukuran file terlalu berat.</p></li>
</ul>
</li>
<li><p>Normalisasi Amplitudo
Terakhir, nilai tegangan (voltase) yang bervariasi diperkecil skalanya (misal menjadi rentang yang seragam). Inilah alasan mengapa di dataset Anda, nilainya berupa angka desimal seperti -0.12, 1.5, -0.8, bukan angka voltase mentah.</p></li>
</ol>
<section id="load-dataset">
<h3><strong>Load Dataset</strong><a class="headerlink" href="#load-dataset" title="Link to this heading">#</a></h3>
<p>link GDrive dataset ecg5000: <a class="reference external" href="https://drive.google.com/drive/folders/1PM-IbBccdFeRQgRgV_ZlmIPRiqZwOtjV?usp=sharing">https://drive.google.com/drive/folders/1PM-IbBccdFeRQgRgV_ZlmIPRiqZwOtjV?usp=sharing</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">imbalanced</span><span class="o">-</span><span class="n">learn</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: imbalanced-learn in /usr/local/python/3.12.1/lib/python3.12/site-packages (0.14.1)
Requirement already satisfied: numpy&lt;3,&gt;=1.25.2 in /usr/local/python/3.12.1/lib/python3.12/site-packages (from imbalanced-learn) (2.3.5)
Requirement already satisfied: scipy&lt;2,&gt;=1.11.4 in /usr/local/python/3.12.1/lib/python3.12/site-packages (from imbalanced-learn) (1.16.3)
Requirement already satisfied: scikit-learn&lt;2,&gt;=1.4.2 in /usr/local/python/3.12.1/lib/python3.12/site-packages (from imbalanced-learn) (1.8.0)
Requirement already satisfied: sklearn-compat&lt;0.2,&gt;=0.1.5 in /usr/local/python/3.12.1/lib/python3.12/site-packages (from imbalanced-learn) (0.1.5)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: joblib&lt;2,&gt;=1.2.0 in /usr/local/python/3.12.1/lib/python3.12/site-packages (from imbalanced-learn) (1.5.3)
Requirement already satisfied: threadpoolctl&lt;4,&gt;=2.0.0 in /usr/local/python/3.12.1/lib/python3.12/site-packages (from imbalanced-learn) (3.6.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">pandas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: pandas in /usr/local/python/3.12.1/lib/python3.12/site-packages (2.3.3)
Requirement already satisfied: numpy&gt;=1.26.0 in /usr/local/python/3.12.1/lib/python3.12/site-packages (from pandas) (2.3.5)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /home/codespace/.local/lib/python3.12/site-packages (from pandas) (2.9.0.post0)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/python/3.12.1/lib/python3.12/site-packages (from pandas) (2025.2)
Requirement already satisfied: tzdata&gt;=2022.7 in /home/codespace/.local/lib/python3.12/site-packages (from pandas) (2025.2)
Requirement already satisfied: six&gt;=1.5 in /home/codespace/.local/lib/python3.12/site-packages (from python-dateutil&gt;=2.8.2-&gt;pandas) (1.17.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">arff</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">train_path</span> <span class="o">=</span> <span class="s2">&quot;/workspaces/PSD/tugas/UAS/ECG5000_TRAIN.arff&quot;</span>
<span class="n">test_path</span>  <span class="o">=</span> <span class="s2">&quot;/workspaces/PSD/tugas/UAS/ECG5000_TEST.arff&quot;</span>

<span class="c1"># Load data</span>
<span class="n">train_data</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">arff</span><span class="o">.</span><span class="n">loadarff</span><span class="p">(</span><span class="n">train_path</span><span class="p">)</span>
<span class="n">test_data</span><span class="p">,</span>  <span class="n">_</span> <span class="o">=</span> <span class="n">arff</span><span class="o">.</span><span class="n">loadarff</span><span class="p">(</span><span class="n">test_path</span><span class="p">)</span>

<span class="c1"># Convert ke DataFrame</span>
<span class="n">df_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span>
<span class="n">df_test</span>  <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

<span class="c1"># ARFF punya label di kolom terakhir bernama &#39;target&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_train</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       att1      att2      att3      att4      att5      att6      att7  \
0 -0.112522 -2.827204 -3.773897 -4.349751 -4.376041 -3.474986 -2.181408   
1 -1.100878 -3.996840 -4.285843 -4.506579 -4.022377 -3.234368 -1.566126   
2 -0.567088 -2.593450 -3.874230 -4.584095 -4.187449 -3.151462 -1.742940   
3  0.490473 -1.914407 -3.616364 -4.318823 -4.268016 -3.881110 -2.993280   
4  0.800232 -0.874252 -2.384761 -3.973292 -4.338224 -3.802422 -2.534510   

       att8      att9     att10  ...    att132    att133    att134    att135  \
0 -1.818286 -1.250522 -0.477492  ...  0.792168  0.933541  0.796958  0.578621   
1 -0.992258 -0.754680  0.042321  ...  0.538356  0.656881  0.787490  0.724046   
2 -1.490659 -1.183580 -0.394229  ...  0.886073  0.531452  0.311377 -0.021919   
3 -1.671131 -1.333884 -0.965629  ...  0.350816  0.499111  0.600345  0.842069   
4 -1.783423 -1.594450 -0.753199  ...  1.148884  0.958434  1.059025  1.371682   

     att136    att137    att138    att139    att140  target  
0  0.257740  0.228077  0.123431  0.925286  0.193137    b&#39;1&#39;  
1  0.555784  0.476333  0.773820  1.119621 -1.436250    b&#39;1&#39;  
2 -0.713683 -0.532197  0.321097  0.904227 -0.421797    b&#39;1&#39;  
3  0.952074  0.990133  1.086798  1.403011 -0.383564    b&#39;1&#39;  
4  1.277392  0.960304  0.971020  1.614392  1.421456    b&#39;1&#39;  

[5 rows x 141 columns]
</pre></div>
</div>
</div>
</div>
</section>
<section id="ukuran-dataset">
<h3><strong>Ukuran Dataset</strong><a class="headerlink" href="#ukuran-dataset" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gabungkan seluruh data untuk analisis</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_train</span><span class="p">,</span> <span class="n">df_test</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Label biasanya dalam bentuk byte -&gt; convert ke int</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(5000, 141)
</pre></div>
</div>
</div>
</div>
</section>
<section id="cek-missing-value">
<h3><strong>Cek Missing Value</strong><a class="headerlink" href="#cek-missing-value" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Missing Value ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="s2">&quot;total missing value&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Missing Value ===
0 total missing value
</pre></div>
</div>
</div>
</div>
</section>
<section id="distribusi-kelas-imbalance">
<h3><strong>Distribusi Kelas (Imbalance)</strong><a class="headerlink" href="#distribusi-kelas-imbalance" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="c1"># df[&#39;target&#39;] sudah berisi int 1–5</span>
<span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Normal&quot;</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;R-on-T PVC&quot;</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;PVC&quot;</span><span class="p">,</span>
    <span class="mi">4</span><span class="p">:</span> <span class="s2">&quot;Supraventricular Premature Beat&quot;</span><span class="p">,</span>
    <span class="mi">5</span><span class="p">:</span> <span class="s2">&quot;Unclassified Beat&quot;</span>
<span class="p">}</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;class_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;class_name&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribusi Kelas ECG5000&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Kelas ECG&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Jumlah Data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;class_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="c1"># df[&#39;target&#39;] sudah berisi int 1–5</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;matplotlib&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-contoh-sinyal-per-kelas">
<h3><strong>Plot Contoh Sinyal per Kelas</strong><a class="headerlink" href="#plot-contoh-sinyal-per-kelas" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ambil nama kolom fitur (kecuali target)</span>
<span class="n">feature_cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># sample sinyal dari setiap kelas</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">classes</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">classes</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">feature_cols</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Contoh Sinyal - Class </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1733416a2085016a6378844aade9bb6061979e2ad4f03828b042e61b0b54b482.png" src="_images/1733416a2085016a6378844aade9bb6061979e2ad4f03828b042e61b0b54b482.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># df berisi 140 kolom fitur dan 1 kolom &#39;target&#39; di akhir</span>
<span class="c1"># pisahkan fitur untuk menghitung statistik</span>
<span class="n">fitur_columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">data_fitur</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">fitur_columns</span><span class="p">]</span>

<span class="c1"># 1. Menghitung &#39;Mean Euclidean Distance&#39; sebagai skor pencilan</span>
<span class="c1"># hitung rata-rata global dari seluruh sinyal</span>
<span class="n">rata_rata_global</span> <span class="o">=</span> <span class="n">data_fitur</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Hitung jarak setiap sampel ke rata-rata global</span>
<span class="n">distansi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">data_fitur</span> <span class="o">-</span> <span class="n">rata_rata_global</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="c1"># 2. Menentukan Threshold menggunakan metode IQR</span>
<span class="n">Q1</span> <span class="o">=</span> <span class="n">distansi</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">Q3</span> <span class="o">=</span> <span class="n">distansi</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
<span class="n">IQR</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">-</span> <span class="n">Q1</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span>

<span class="c1"># Identifikasi outlier</span>
<span class="n">outliers</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">distansi</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">]</span>
<span class="n">clean_data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">distansi</span> <span class="o">&lt;=</span> <span class="n">threshold</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Hasil Deteksi Outlier&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah Outlier terdeteksi: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">outliers</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Persentase Outlier: </span><span class="si">{</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">outliers</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

<span class="c1"># 3. Visualisasi Perbandingan</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Plot Sinyal Normal (Acak)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">clean_data</span><span class="p">))):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">clean_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Contoh Sinyal Normal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Plot Sinyal Outlier</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">outliers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">outliers</span><span class="p">)):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">outliers</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sinyal Outlier (Bentuk Tidak Wajar)&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;Tidak ada outlier terdeteksi&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Hasil Deteksi Outlier
Jumlah Outlier terdeteksi: 101
Persentase Outlier: 2.02%
</pre></div>
</div>
<img alt="_images/874fca66b1f9fc8afe947925ae6dd9ea95713db70967a9055656f4d1ce35de05.png" src="_images/874fca66b1f9fc8afe947925ae6dd9ea95713db70967a9055656f4d1ce35de05.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Menggunakan data yang sudah bersih dari outlier</span>
<span class="n">df_final</span> <span class="o">=</span> <span class="n">clean_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ukuran dataset sebelum dibersihkan: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ukuran dataset setelah outlier dihapus: </span><span class="si">{</span><span class="n">df_final</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Reset index agar rapi kembali</span>
<span class="n">df_final</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

 <span class="c1"># Tentukan path penyimpanan (sesuaikan dengan folder kerja Anda)</span>
<span class="n">output_path</span> <span class="o">=</span> <span class="s2">&quot;/workspaces/PSD/tugas/UAS/ECG5000_Cleaned.csv&quot;</span>


<span class="c1"># Simpan ke CSV</span>
<span class="c1"># index=False agar tidak menambah kolom baru (Unnamed: 0)</span>
<span class="n">df_final</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Dataset berhasil disimpan ke: </span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ukuran dataset sebelum dibersihkan: (5000, 142)
Ukuran dataset setelah outlier dihapus: (4899, 142)
✅ Dataset berhasil disimpan ke: /workspaces/PSD/tugas/UAS/ECG5000_Cleaned.csv
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="pre-processing">
<h2><strong>Pre Processing</strong><a class="headerlink" href="#pre-processing" title="Link to this heading">#</a></h2>
<p>Tahap preprocessing ini mengikuti prinsip standardisasi data fisiologis yang dikemukakan dalam PhysioToolkit, di mana sinyal harus bebas dari variasi teknis agar fitur morfologis jantung dapat terlihat jelas. Selain itu, teknik penyeimbangan kelas diterapkan untuk mengakomodasi distribusi data dari rekaman chf07 yang secara alami memiliki lebih banyak detak jantung normal daripada anomali.</p>
<section id="normalisasi-data-menggunakan-min-max-scalling">
<h3><strong>Normalisasi Data menggunakan Min-Max Scalling</strong><a class="headerlink" href="#normalisasi-data-menggunakan-min-max-scalling" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># 1. Menentukan kolom fitur (140 titik waktu)</span>
<span class="c1"># abaikan kolom &#39;target&#39; dan &#39;class_name&#39; saat normalisasi</span>
<span class="n">feature_cols</span> <span class="o">=</span> <span class="n">df_final</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="s1">&#39;class_name&#39;</span><span class="p">])</span>

<span class="c1"># 2. NORMALISASI (Min-Max Scaling)</span>
<span class="c1"># Mengubah rentang nilai sinyal menjadi 0 sampai 1 agar model lebih stabil</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="n">feature_cols</span><span class="p">])</span>

<span class="c1"># 3. PENGGABUNGAN KEMBALI</span>
<span class="c1"># Membuat DataFrame baru untuk hasil preprocessing</span>
<span class="n">df_preprocessed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">feature_cols</span><span class="p">)</span>
<span class="n">df_preprocessed</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Mengambil nilai integer asli</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✅ Preprocessing Selesai&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bentuk data: </span><span class="si">{</span><span class="n">df_preprocessed</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rentang nilai fitur (Min): </span><span class="si">{</span><span class="n">df_preprocessed</span><span class="p">[</span><span class="n">feature_cols</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rentang nilai fitur (Max): </span><span class="si">{</span><span class="n">df_preprocessed</span><span class="p">[</span><span class="n">feature_cols</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Statistik per-kelas (setelah normalisasi):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_preprocessed</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;target&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✅ Preprocessing Selesai
Bentuk data: (4899, 141)
Rentang nilai fitur (Min): 0.0
Rentang nilai fitur (Max): 1.0000000000000002

Statistik per-kelas (setelah normalisasi):
target
1    2891
2    1716
3      87
4     188
5      17
dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="split-data-dan-menyeimbangkan-data-dengan-smote">
<h3><strong>Split Data dan Menyeimbangkan Data dengan SMOTE</strong><a class="headerlink" href="#split-data-dan-menyeimbangkan-data-dengan-smote" title="Link to this heading">#</a></h3>
<p>SMOTE bekerja dengan cara membuat sampel “sintetis” baru untuk kelas minoritas (2, 3, 4, dan 5), bukan sekadar menduplikasi data yang sudah ada. Teknik ini menciptakan titik data baru di antara sampel yang sudah ada sehingga model dapat mempelajari batas keputusan (decision boundary) yang lebih baik untuk deteksi penyakit jantung</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">imblearn.over_sampling</span><span class="w"> </span><span class="kn">import</span> <span class="n">SMOTE</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># 1. PISAHKAN FITUR DAN TARGET</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df_preprocessed</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df_preprocessed</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>

<span class="c1"># 2. STRATIFIED TRAIN-TEST SPLIT</span>
<span class="c1"># Stratify=y memastikan proporsi kelas di train dan test sama dengan aslinya</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah data Train asli: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah data Test (Murni): </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Distribusi kelas di y_train sebelum SMOTE: </span><span class="si">{</span><span class="n">Counter</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 3. TERAPKAN SMOTE HANYA PADA DATA TRAIN</span>
<span class="c1"># Ini mencegah &#39;Data Leakage&#39; karena model tidak pernah melihat data sintetis di data uji</span>
<span class="n">smote</span> <span class="o">=</span> <span class="n">SMOTE</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X_train_balanced</span><span class="p">,</span> <span class="n">y_train_balanced</span> <span class="o">=</span> <span class="n">smote</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Distribusi kelas di y_train setelah SMOTE: </span><span class="si">{</span><span class="n">Counter</span><span class="p">(</span><span class="n">y_train_balanced</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Distribusi kelas di y_test (Tetap Asli): </span><span class="si">{</span><span class="n">Counter</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jumlah data Train asli: 3919
Jumlah data Test (Murni): 980
Distribusi kelas di y_train sebelum SMOTE: Counter({1: 2313, 2: 1373, 4: 150, 3: 69, 5: 14})
------------------------------
Distribusi kelas di y_train setelah SMOTE: Counter({2: 2313, 1: 2313, 4: 2313, 3: 2313, 5: 2313})
Distribusi kelas di y_test (Tetap Asli): Counter({1: 578, 2: 343, 4: 38, 3: 18, 5: 3})
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="modelling-data">
<h2><strong>Modelling Data</strong><a class="headerlink" href="#modelling-data" title="Link to this heading">#</a></h2>
<section id="random-forest">
<h3><strong>Random Forest</strong><a class="headerlink" href="#random-forest" title="Link to this heading">#</a></h3>
<p>Model Random Forest adalah algoritma machine learning yang menggabungkan banyak decision tree (pohon keputusan) untuk menghasilkan prediksi yang lebih akurat dan stabil, dengan mengurangi overfitting (terlalu spesifik pada data latih). Cara kerjanya adalah membangun banyak pohon keputusan secara paralel, di mana setiap pohon dilatih pada sampel data dan subset fitur yang berbeda (acak), lalu hasil akhirnya didapat dari pemungutan suara mayoritas (klasifikasi) atau rata-rata (regresi) dari semua pohon tersebut</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">accuracy_score</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">joblib</span>

<span class="c1"># 1. Inisialisasi Model</span>
<span class="c1"># n_estimators=100 (jumlah pohon), n_jobs=-1 (menggunakan semua core CPU agar cepat)</span>
<span class="n">model_rf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># 2. Pelatihan pada Data yang sudah di-SMOTE</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;⏳ Melatih Random Forest pada data seimbang...&quot;</span><span class="p">)</span>
<span class="n">model_rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_balanced</span><span class="p">,</span> <span class="n">y_train_balanced</span><span class="p">)</span>

<span class="c1"># 3. Prediksi pada Data Test Murni</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model_rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># 4. Evaluasi</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">✅ Hasil Klasifikasi pada Data Uji Asli:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Akurasi: </span><span class="si">{</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Detail Per-Kelas:&quot;</span><span class="p">)</span>
<span class="n">target_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Normal&quot;</span><span class="p">,</span> <span class="s2">&quot;R-on-T PVC&quot;</span><span class="p">,</span> <span class="s2">&quot;PVC&quot;</span><span class="p">,</span> <span class="s2">&quot;Supraventricular&quot;</span><span class="p">,</span> <span class="s2">&quot;Unclassified&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">target_names</span><span class="o">=</span><span class="n">target_names</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>⏳ Melatih Random Forest pada data seimbang...

✅ Hasil Klasifikasi pada Data Uji Asli:
Akurasi: 0.9541

Detail Per-Kelas:
                  precision    recall  f1-score   support

          Normal       0.98      1.00      0.99       578
      R-on-T PVC       0.94      0.97      0.95       343
             PVC       0.58      0.61      0.59        18
Supraventricular       0.71      0.39      0.51        38
    Unclassified       0.00      0.00      0.00         3

        accuracy                           0.95       980
       macro avg       0.64      0.59      0.61       980
    weighted avg       0.95      0.95      0.95       980
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/codespace/.local/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f&quot;{metric.capitalize()} is&quot;, result.shape[0])
/home/codespace/.local/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f&quot;{metric.capitalize()} is&quot;, result.shape[0])
/home/codespace/.local/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f&quot;{metric.capitalize()} is&quot;, result.shape[0])
</pre></div>
</div>
</div>
</div>
</section>
<section id="d-cnn">
<h3><strong>1D CNN</strong><a class="headerlink" href="#d-cnn" title="Link to this heading">#</a></h3>
<p>Model CNN (Convolutional Neural Network) adalah jenis jaringan saraf tiruan (deep learning) yang dirancang khusus untuk menganalisis data visual seperti gambar, dengan cara mengidentifikasi pola-pola lokal secara otomatis melalui lapisan konvolusi, menjadikannya sangat efektif untuk tugas-tugas seperti klasifikasi, deteksi, dan segmentasi objek, contohnya pengenalan wajah, mobil otonom, hingga analisis citra medis. CNN mempertahankan struktur spasial data (piksel) daripada “meratakannya” seperti model saraf biasa, sehingga mampu belajar mengenali objek meski ada variasi posisi atau kondisi</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">tensorflow</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting tensorflow
  Downloading tensorflow-2.20.0-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.5 kB)
Collecting absl-py&gt;=1.0.0 (from tensorflow)
  Downloading absl_py-2.3.1-py3-none-any.whl.metadata (3.3 kB)
Collecting astunparse&gt;=1.6.0 (from tensorflow)
  Downloading astunparse-1.6.3-py2.py3-none-any.whl.metadata (4.4 kB)
Collecting flatbuffers&gt;=24.3.25 (from tensorflow)
  Downloading flatbuffers-25.9.23-py2.py3-none-any.whl.metadata (875 bytes)
Collecting gast!=0.5.0,!=0.5.1,!=0.5.2,&gt;=0.2.1 (from tensorflow)
  Downloading gast-0.7.0-py3-none-any.whl.metadata (1.5 kB)
Collecting google_pasta&gt;=0.1.1 (from tensorflow)
  Downloading google_pasta-0.2.0-py3-none-any.whl.metadata (814 bytes)
Collecting libclang&gt;=13.0.0 (from tensorflow)
  Downloading libclang-18.1.1-py2.py3-none-manylinux2010_x86_64.whl.metadata (5.2 kB)
Collecting opt_einsum&gt;=2.3.2 (from tensorflow)
  Downloading opt_einsum-3.4.0-py3-none-any.whl.metadata (6.3 kB)
Requirement already satisfied: packaging in /home/codespace/.local/lib/python3.12/site-packages (from tensorflow) (25.0)
Collecting protobuf&gt;=5.28.0 (from tensorflow)
  Downloading protobuf-6.33.2-cp39-abi3-manylinux2014_x86_64.whl.metadata (593 bytes)
Requirement already satisfied: requests&lt;3,&gt;=2.21.0 in /home/codespace/.local/lib/python3.12/site-packages (from tensorflow) (2.32.5)
Requirement already satisfied: setuptools in /home/codespace/.local/lib/python3.12/site-packages (from tensorflow) (80.9.0)
Requirement already satisfied: six&gt;=1.12.0 in /home/codespace/.local/lib/python3.12/site-packages (from tensorflow) (1.17.0)
Collecting termcolor&gt;=1.1.0 (from tensorflow)
  Downloading termcolor-3.2.0-py3-none-any.whl.metadata (6.4 kB)
Requirement already satisfied: typing_extensions&gt;=3.6.6 in /home/codespace/.local/lib/python3.12/site-packages (from tensorflow) (4.15.0)
Collecting wrapt&gt;=1.11.0 (from tensorflow)
  Downloading wrapt-2.0.1-cp312-cp312-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl.metadata (9.0 kB)
Collecting grpcio&lt;2.0,&gt;=1.24.3 (from tensorflow)
  Downloading grpcio-1.76.0-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (3.7 kB)
Collecting tensorboard~=2.20.0 (from tensorflow)
  Downloading tensorboard-2.20.0-py3-none-any.whl.metadata (1.8 kB)
Collecting keras&gt;=3.10.0 (from tensorflow)
  Downloading keras-3.12.0-py3-none-any.whl.metadata (5.9 kB)
Requirement already satisfied: numpy&gt;=1.26.0 in /home/codespace/.local/lib/python3.12/site-packages (from tensorflow) (2.3.4)
Collecting h5py&gt;=3.11.0 (from tensorflow)
  Downloading h5py-3.15.1-cp312-cp312-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl.metadata (3.0 kB)
Collecting ml_dtypes&lt;1.0.0,&gt;=0.5.1 (from tensorflow)
  Downloading ml_dtypes-0.5.4-cp312-cp312-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl.metadata (8.9 kB)
Requirement already satisfied: charset_normalizer&lt;4,&gt;=2 in /home/codespace/.local/lib/python3.12/site-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorflow) (3.4.4)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /home/codespace/.local/lib/python3.12/site-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorflow) (3.11)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /home/codespace/.local/lib/python3.12/site-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorflow) (2.5.0)
Requirement already satisfied: certifi&gt;=2017.4.17 in /home/codespace/.local/lib/python3.12/site-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorflow) (2025.10.5)
Collecting markdown&gt;=2.6.8 (from tensorboard~=2.20.0-&gt;tensorflow)
  Downloading markdown-3.10-py3-none-any.whl.metadata (5.1 kB)
Requirement already satisfied: pillow in /home/codespace/.local/lib/python3.12/site-packages (from tensorboard~=2.20.0-&gt;tensorflow) (12.0.0)
Collecting tensorboard-data-server&lt;0.8.0,&gt;=0.7.0 (from tensorboard~=2.20.0-&gt;tensorflow)
  Downloading tensorboard_data_server-0.7.2-py3-none-manylinux_2_31_x86_64.whl.metadata (1.1 kB)
Collecting werkzeug&gt;=1.0.1 (from tensorboard~=2.20.0-&gt;tensorflow)
  Downloading werkzeug-3.1.4-py3-none-any.whl.metadata (4.0 kB)
Collecting wheel&lt;1.0,&gt;=0.23.0 (from astunparse&gt;=1.6.0-&gt;tensorflow)
  Downloading wheel-0.45.1-py3-none-any.whl.metadata (2.3 kB)
Collecting rich (from keras&gt;=3.10.0-&gt;tensorflow)
  Downloading rich-14.2.0-py3-none-any.whl.metadata (18 kB)
Collecting namex (from keras&gt;=3.10.0-&gt;tensorflow)
  Downloading namex-0.1.0-py3-none-any.whl.metadata (322 bytes)
Collecting optree (from keras&gt;=3.10.0-&gt;tensorflow)
  Downloading optree-0.18.0-cp312-cp312-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl.metadata (34 kB)
Requirement already satisfied: markupsafe&gt;=2.1.1 in /home/codespace/.local/lib/python3.12/site-packages (from werkzeug&gt;=1.0.1-&gt;tensorboard~=2.20.0-&gt;tensorflow) (3.0.3)
Collecting markdown-it-py&gt;=2.2.0 (from rich-&gt;keras&gt;=3.10.0-&gt;tensorflow)
  Downloading markdown_it_py-4.0.0-py3-none-any.whl.metadata (7.3 kB)
Requirement already satisfied: pygments&lt;3.0.0,&gt;=2.13.0 in /home/codespace/.local/lib/python3.12/site-packages (from rich-&gt;keras&gt;=3.10.0-&gt;tensorflow) (2.19.2)
Collecting mdurl~=0.1 (from markdown-it-py&gt;=2.2.0-&gt;rich-&gt;keras&gt;=3.10.0-&gt;tensorflow)
  Downloading mdurl-0.1.2-py3-none-any.whl.metadata (1.6 kB)
Downloading tensorflow-2.20.0-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (620.7 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">620.7/620.7 MB</span> <span class=" -Color -Color-Red">18.7 MB/s</span>  <span class=" -Color -Color-Yellow">0:00:16</span>m0:00:0100:01
?25hDownloading grpcio-1.76.0-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (6.6 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">6.6/6.6 MB</span> <span class=" -Color -Color-Red">49.8 MB/s</span>  <span class=" -Color -Color-Yellow">0:00:00</span>
?25hDownloading ml_dtypes-0.5.4-cp312-cp312-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl (5.0 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">5.0/5.0 MB</span> <span class=" -Color -Color-Red">36.9 MB/s</span>  <span class=" -Color -Color-Yellow">0:00:00</span>
?25hDownloading tensorboard-2.20.0-py3-none-any.whl (5.5 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">5.5/5.5 MB</span> <span class=" -Color -Color-Red">44.8 MB/s</span>  <span class=" -Color -Color-Yellow">0:00:00</span>
?25hDownloading tensorboard_data_server-0.7.2-py3-none-manylinux_2_31_x86_64.whl (6.6 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">6.6/6.6 MB</span> <span class=" -Color -Color-Red">38.2 MB/s</span>  <span class=" -Color -Color-Yellow">0:00:00</span>
?25hDownloading absl_py-2.3.1-py3-none-any.whl (135 kB)
Downloading astunparse-1.6.3-py2.py3-none-any.whl (12 kB)
Downloading wheel-0.45.1-py3-none-any.whl (72 kB)
Downloading flatbuffers-25.9.23-py2.py3-none-any.whl (30 kB)
Downloading gast-0.7.0-py3-none-any.whl (22 kB)
Downloading google_pasta-0.2.0-py3-none-any.whl (57 kB)
Downloading h5py-3.15.1-cp312-cp312-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl (5.1 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">5.1/5.1 MB</span> <span class=" -Color -Color-Red">46.6 MB/s</span>  <span class=" -Color -Color-Yellow">0:00:00</span>
?25hDownloading keras-3.12.0-py3-none-any.whl (1.5 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">1.5/1.5 MB</span> <span class=" -Color -Color-Red">54.6 MB/s</span>  <span class=" -Color -Color-Yellow">0:00:00</span>
?25hDownloading libclang-18.1.1-py2.py3-none-manylinux2010_x86_64.whl (24.5 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">24.5/24.5 MB</span> <span class=" -Color -Color-Red">45.3 MB/s</span>  <span class=" -Color -Color-Yellow">0:00:00</span>6m0:00:01
?25hDownloading markdown-3.10-py3-none-any.whl (107 kB)
Downloading opt_einsum-3.4.0-py3-none-any.whl (71 kB)
Downloading protobuf-6.33.2-cp39-abi3-manylinux2014_x86_64.whl (323 kB)
Downloading termcolor-3.2.0-py3-none-any.whl (7.7 kB)
Downloading werkzeug-3.1.4-py3-none-any.whl (224 kB)
Downloading wrapt-2.0.1-cp312-cp312-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl (121 kB)
Downloading namex-0.1.0-py3-none-any.whl (5.9 kB)
Downloading optree-0.18.0-cp312-cp312-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl (408 kB)
Downloading rich-14.2.0-py3-none-any.whl (243 kB)
Downloading markdown_it_py-4.0.0-py3-none-any.whl (87 kB)
Downloading mdurl-0.1.2-py3-none-any.whl (10.0 kB)
Installing collected packages: namex, libclang, flatbuffers, wrapt, wheel, werkzeug, termcolor, tensorboard-data-server, protobuf, optree, opt_einsum, ml_dtypes, mdurl, markdown, h5py, grpcio, google_pasta, gast, absl-py, tensorboard, markdown-it-py, astunparse, rich, keras, tensorflow
   ━━━━━━╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green"> 4/25</span> [wheel]ng]<span class=" -Color -Color-Yellow">  WARNING: The script wheel is installed in &#39;/usr/local/python/3.12.1/bin&#39; which is not on PATH.</span>
<span class=" -Color -Color-Yellow">  Consider adding this directory to PATH or, if you prefer to suppress this warning, use --no-warn-script-location.</span>
<span class=" -Color -Color-Yellow">   ━━━━━━━━━━━━━━━━━━━━</span>╸━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">13/25</span> [markdown]<span class=" -Color -Color-Yellow">  WARNING: The script markdown_py is installed in &#39;/usr/local/python/3.12.1/bin&#39; which is not on PATH.</span>
<span class=" -Color -Color-Yellow">  Consider adding this directory to PATH or, if you prefer to suppress this warning, use --no-warn-script-location.</span>
<span class=" -Color -Color-Yellow">   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>╺━━━━━━━━━ <span class=" -Color -Color-Green">19/25</span> [tensorboard]<span class=" -Color -Color-Yellow">  WARNING: The script tensorboard is installed in &#39;/usr/local/python/3.12.1/bin&#39; which is not on PATH.</span>
<span class=" -Color -Color-Yellow">  Consider adding this directory to PATH or, if you prefer to suppress this warning, use --no-warn-script-location.</span>
<span class=" -Color -Color-Yellow">  WARNING: The script markdown-it is installed in &#39;/usr/local/python/3.12.1/bin&#39; which is not on PATH.</span>
<span class=" -Color -Color-Yellow">  Consider adding this directory to PATH or, if you prefer to suppress this warning, use --no-warn-script-location.</span>
<span class=" -Color -Color-Yellow">   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>╺━ <span class=" -Color -Color-Green">24/25</span> [tensorflow]<span class=" -Color -Color-Yellow">  WARNING: The scripts import_pb_to_tensorboard, saved_model_cli, tensorboard, tf_upgrade_v2, tflite_convert and toco are installed in &#39;/usr/local/python/3.12.1/bin&#39; which is not on PATH.</span>
<span class=" -Color -Color-Yellow">  Consider adding this directory to PATH or, if you prefer to suppress this warning, use --no-warn-script-location.</span>
<span class=" -Color -Color-Yellow">   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Green">25/25</span> [tensorflow]5 [tensorflow]
Successfully installed absl-py-2.3.1 astunparse-1.6.3 flatbuffers-25.9.23 gast-0.7.0 google_pasta-0.2.0 grpcio-1.76.0 h5py-3.15.1 keras-3.12.0 libclang-18.1.1 markdown-3.10 markdown-it-py-4.0.0 mdurl-0.1.2 ml_dtypes-0.5.4 namex-0.1.0 opt_einsum-3.4.0 optree-0.18.0 protobuf-6.33.2 rich-14.2.0 tensorboard-2.20.0 tensorboard-data-server-0.7.2 tensorflow-2.20.0 termcolor-3.2.0 werkzeug-3.1.4 wheel-0.45.1 wrapt-2.0.1
Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">to_categorical</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Conv1D</span><span class="p">,</span> <span class="n">MaxPooling1D</span><span class="p">,</span> <span class="n">Flatten</span><span class="p">,</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span>

<span class="c1"># reshape untuk CNN</span>
<span class="n">X_train_cnn</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">X_test_cnn</span>  <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># label ke 0–4</span>
<span class="n">y_train_cnn</span> <span class="o">=</span> <span class="n">to_categorical</span><span class="p">(</span><span class="n">y_train</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y_test_cnn</span>  <span class="o">=</span> <span class="n">to_categorical</span><span class="p">(</span><span class="n">y_test</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>


<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">([</span>
    <span class="n">Conv1D</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">140</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span>
    <span class="n">MaxPooling1D</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">Conv1D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
    <span class="n">MaxPooling1D</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">Flatten</span><span class="p">(),</span>
    <span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
    <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span>
    <span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span>
    <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;categorical_crossentropy&#39;</span><span class="p">,</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">X_train_cnn</span><span class="p">,</span>
    <span class="n">y_train_cnn</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_cnn</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-14 13:37:54.558610: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:31] Could not find cuda drivers on your machine, GPU will not be used.
2025-12-14 13:37:55.652598: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-12-14 13:38:00.134652: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:31] Could not find cuda drivers on your machine, GPU will not be used.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/30
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/python/3.12.1/lib/python3.12/site-packages/keras/src/layers/convolutional/base_conv.py:113: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
2025-12-14 13:38:00.883827: E external/local_xla/xla/stream_executor/cuda/cuda_platform.cc:51] failed call to cuInit: INTERNAL: CUDA error: Failed call to cuInit: UNKNOWN ERROR (303)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">5s</span> 24ms/step - accuracy: 0.7638 - loss: 0.6845 - val_accuracy: 0.9107 - val_loss: 0.2845
Epoch 2/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">5s</span> 22ms/step - accuracy: 0.9237 - loss: 0.3040 - val_accuracy: 0.9260 - val_loss: 0.2179
Epoch 3/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">2s</span> 12ms/step - accuracy: 0.9322 - loss: 0.2559 - val_accuracy: 0.9362 - val_loss: 0.1956
Epoch 4/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 8ms/step - accuracy: 0.9376 - loss: 0.2388 - val_accuracy: 0.9515 - val_loss: 0.1654
Epoch 5/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 6ms/step - accuracy: 0.9385 - loss: 0.2275 - val_accuracy: 0.9439 - val_loss: 0.1612
Epoch 6/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 6ms/step - accuracy: 0.9379 - loss: 0.2203 - val_accuracy: 0.9413 - val_loss: 0.1539
Epoch 7/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 6ms/step - accuracy: 0.9427 - loss: 0.2044 - val_accuracy: 0.9566 - val_loss: 0.1440
Epoch 8/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 7ms/step - accuracy: 0.9399 - loss: 0.2054 - val_accuracy: 0.9592 - val_loss: 0.1448
Epoch 9/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 7ms/step - accuracy: 0.9470 - loss: 0.1924 - val_accuracy: 0.9566 - val_loss: 0.1358
Epoch 10/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 6ms/step - accuracy: 0.9441 - loss: 0.1960 - val_accuracy: 0.9566 - val_loss: 0.1408
Epoch 11/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 7ms/step - accuracy: 0.9436 - loss: 0.1935 - val_accuracy: 0.9566 - val_loss: 0.1326
Epoch 12/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 6ms/step - accuracy: 0.9447 - loss: 0.1903 - val_accuracy: 0.9592 - val_loss: 0.1298
Epoch 13/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 6ms/step - accuracy: 0.9470 - loss: 0.1758 - val_accuracy: 0.9592 - val_loss: 0.1303
Epoch 14/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 6ms/step - accuracy: 0.9473 - loss: 0.1730 - val_accuracy: 0.9592 - val_loss: 0.1305
Epoch 15/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 6ms/step - accuracy: 0.9464 - loss: 0.1798 - val_accuracy: 0.9668 - val_loss: 0.1273
Epoch 16/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 7ms/step - accuracy: 0.9504 - loss: 0.1718 - val_accuracy: 0.9592 - val_loss: 0.1265
Epoch 17/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 8ms/step - accuracy: 0.9529 - loss: 0.1663 - val_accuracy: 0.9592 - val_loss: 0.1232
Epoch 18/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 6ms/step - accuracy: 0.9521 - loss: 0.1717 - val_accuracy: 0.9643 - val_loss: 0.1239
Epoch 19/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 6ms/step - accuracy: 0.9492 - loss: 0.1638 - val_accuracy: 0.9668 - val_loss: 0.1201
Epoch 20/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 6ms/step - accuracy: 0.9507 - loss: 0.1645 - val_accuracy: 0.9668 - val_loss: 0.1214
Epoch 21/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 7ms/step - accuracy: 0.9527 - loss: 0.1629 - val_accuracy: 0.9694 - val_loss: 0.1207
Epoch 22/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 6ms/step - accuracy: 0.9524 - loss: 0.1608 - val_accuracy: 0.9668 - val_loss: 0.1178
Epoch 23/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 6ms/step - accuracy: 0.9558 - loss: 0.1587 - val_accuracy: 0.9643 - val_loss: 0.1197
Epoch 24/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 7ms/step - accuracy: 0.9515 - loss: 0.1599 - val_accuracy: 0.9643 - val_loss: 0.1201
Epoch 25/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 6ms/step - accuracy: 0.9507 - loss: 0.1621 - val_accuracy: 0.9694 - val_loss: 0.1176
Epoch 26/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 6ms/step - accuracy: 0.9541 - loss: 0.1620 - val_accuracy: 0.9668 - val_loss: 0.1194
Epoch 27/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 6ms/step - accuracy: 0.9524 - loss: 0.1568 - val_accuracy: 0.9617 - val_loss: 0.1227
Epoch 28/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 6ms/step - accuracy: 0.9552 - loss: 0.1526 - val_accuracy: 0.9617 - val_loss: 0.1164
Epoch 29/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 6ms/step - accuracy: 0.9527 - loss: 0.1530 - val_accuracy: 0.9719 - val_loss: 0.1181
Epoch 30/30
<span class=" -Color -Color-Bold">111/111</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 8ms/step - accuracy: 0.9541 - loss: 0.1567 - val_accuracy: 0.9617 - val_loss: 0.1173
<span class=" -Color -Color-Bold">31/31</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 4ms/step
              precision    recall  f1-score   support

           1       0.99      1.00      0.99       578
           2       0.92      0.99      0.95       343
           3       0.82      0.50      0.62        18
           4       0.88      0.37      0.52        38
           5       0.00      0.00      0.00         3

    accuracy                           0.96       980
   macro avg       0.72      0.57      0.62       980
weighted avg       0.95      0.96      0.95       980
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/codespace/.local/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f&quot;{metric.capitalize()} is&quot;, result.shape[0])
/home/codespace/.local/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f&quot;{metric.capitalize()} is&quot;, result.shape[0])
/home/codespace/.local/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f&quot;{metric.capitalize()} is&quot;, result.shape[0])
</pre></div>
</div>
</div>
</div>
<p>Kelas 5 tetap tidak terdeteksi sama sekali. Hal ini terjadi karena jumlah sampel asli (hanya 14 di train dan 3 di test) terlalu sedikit bagi jaringan saraf untuk membangun representasi fitur yang reliabel tentang apa itu “Unclassified Beat.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">joblib</span>

<span class="c1"># Simpan Model CNN</span>
<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;/workspaces/PSD/tugas/UAS/model_cnn_final.h5&quot;</span><span class="p">)</span>

<span class="c1"># Simpan Scaler (Pastikan variabel &#39;scaler&#39; sudah didefinisikan sebelumnya)</span>
<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">scaler</span><span class="p">,</span> <span class="s2">&quot;/workspaces/PSD/tugas/UAS/scaler_final.pkl&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✅ Model (.h5) dan Scaler (.pkl) telah berhasil disimpan!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save(&#39;my_model.keras&#39;)` or `keras.saving.save_model(model, &#39;my_model.keras&#39;)`. 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✅ Model (.h5) dan Scaler (.pkl) telah berhasil disimpan!
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="evaluasi">
<h2><strong>Evaluasi</strong><a class="headerlink" href="#evaluasi" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">f1_score</span>

<span class="c1"># 1. MENDAPATKAN PREDIKSI</span>
<span class="c1"># Prediksi Random Forest</span>
<span class="n">y_pred_rf</span> <span class="o">=</span> <span class="n">model_rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Prediksi CNN (Perlu argmax karena outputnya softmax)</span>
<span class="n">y_pred_cnn_prob</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_cnn</span><span class="p">)</span>
<span class="n">y_pred_cnn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y_pred_cnn_prob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># +1 untuk mengembalikan ke label 1-5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">31/31</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 3ms/step
</pre></div>
</div>
</div>
</div>
<section id="table-comparison">
<h3><strong>Table Comparison</strong><a class="headerlink" href="#table-comparison" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 2. TABEL PERBANDINGAN PERFORMA</span>
<span class="n">metrics_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Model&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Random Forest (Baseline)&#39;</span><span class="p">,</span> <span class="s1">&#39;CNN (Main Model)&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Accuracy&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_rf</span><span class="p">),</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_cnn</span><span class="p">)],</span>
    <span class="s1">&#39;Macro F1-Score&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_rf</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">),</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_cnn</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">)]</span>
<span class="p">}</span>
<span class="n">df_comparison</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metrics_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== 📊 PERBANDINGAN MODEL ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_comparison</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== 📊 PERBANDINGAN MODEL ===
                      Model  Accuracy  Macro F1-Score
0  Random Forest (Baseline)  0.954082        0.609299
1          CNN (Main Model)  0.958163        0.617011
</pre></div>
</div>
</div>
</div>
</section>
<section id="confusion-matrix">
<h3><strong>Confusion Matrix</strong><a class="headerlink" href="#confusion-matrix" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 3. VISUALISASI CONFUSION MATRIX (SIDE-BY-SIDE)</span>
<span class="n">target_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Normal&quot;</span><span class="p">,</span> <span class="s2">&quot;R-on-T PVC&quot;</span><span class="p">,</span> <span class="s2">&quot;PVC&quot;</span><span class="p">,</span> <span class="s2">&quot;Supraventricular&quot;</span><span class="p">,</span> <span class="s2">&quot;Unclassified&quot;</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># RF Matrix</span>
<span class="n">cm_rf</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_rf</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm_rf</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">xticklabels</span><span class="o">=</span><span class="n">target_names</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="n">target_names</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix: Random Forest&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Prediksi&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Aktual&quot;</span><span class="p">)</span>

<span class="c1"># CNN Matrix</span>
<span class="n">cm_cnn</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_cnn</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm_cnn</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greens&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">xticklabels</span><span class="o">=</span><span class="n">target_names</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="n">target_names</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix: CNN&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Prediksi&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Aktual&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b9e1e4e9da9b31ac0c4772cb32dbd9a6dd1254bc0a2e25e7d42c502f42143b20.png" src="_images/b9e1e4e9da9b31ac0c4772cb32dbd9a6dd1254bc0a2e25e7d42c502f42143b20.png" />
</div>
</div>
<p>Dominasi Kelas 1 (Normal): kotak kiri atas memiliki angka terbesar (578 sampel), menunjukkan model sangat stabil dalam mengenali detak jantung normal karena jumlah data pelatihannya yang melimpah.</p>
<p>Performa Anomali (Kelas 2-4):</p>
<ul class="simple">
<li><p>R-on-T PVC (Kelas 2): Dengan recall 97%, sebagian besar sampel masuk di diagonal utama</p></li>
<li><p>PVC &amp; Supraventricular (Kelas 3-4): terlihat beberapa angka “berceceran” di luar diagonal. Ini menunjukkan morfologi sinyal pada rekaman chf07 untuk kelas ini terkadang memiliki kemiripan visual yang tinggi, sehingga CNN kesulitan membedakannya secara sempurna</p></li>
</ul>
<p>Masalah Kelas 5 (Unclassified): Baris terakhir pada sumbu aktual mungkin akan kosong di bagian diagonal (angka 0). Ini mengonfirmasi bahwa model tidak mampu memprediksi satu pun dari 3 sampel asli karena kelangkaan data di PhysioNet.</p>
</section>
<section id="visualisasi-prediksi-sinyal">
<h3><strong>Visualisasi Prediksi Sinyal</strong><a class="headerlink" href="#visualisasi-prediksi-sinyal" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Menghitung rata-rata sinyal per kelas dari data train untuk perbandingan</span>
<span class="c1"># Ini membantu melihat &quot;bentuk standar&quot; dari kelas yang diprediksi</span>
<span class="n">class_means</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span> <span class="c1"># Hanya kelas 1-4 (karena kelas 5 diabaikan)</span>
    <span class="n">class_means</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="n">y_train</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="c1"># Mengambil 4 sampel pertama dari data test</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># 1. Plot Sinyal Aktual dari User (Data Test)</span>
    <span class="n">actual_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">pred_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y_pred_cnn</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Sinyal Pasien (Aktual: </span><span class="si">{</span><span class="n">target_names</span><span class="p">[</span><span class="n">actual_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

    <span class="c1"># 2. Plot Rata-rata Morfologi dari Kelas yang Diprediksi Model</span>
    <span class="c1"># Jika prediksi salah, kita bisa melihat perbedaan bentuknya di sini</span>
    <span class="k">if</span> <span class="n">pred_idx</span> <span class="ow">in</span> <span class="n">class_means</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">class_means</span><span class="p">[</span><span class="n">pred_idx</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Tipikal Pola Prediksi (</span><span class="si">{</span><span class="n">target_names</span><span class="p">[</span><span class="n">pred_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                 <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">actual_name</span> <span class="o">=</span> <span class="n">target_names</span><span class="p">[</span><span class="n">actual_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">pred_name</span> <span class="o">=</span> <span class="n">target_names</span><span class="p">[</span><span class="n">pred_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span> <span class="k">if</span> <span class="n">actual_name</span> <span class="o">==</span> <span class="n">pred_name</span> <span class="k">else</span> <span class="s1">&#39;red&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SAMPEL </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="se">\n</span><span class="s2">Prediksi CNN: </span><span class="si">{</span><span class="n">pred_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Waktu (Timesteps)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Amplitudo Ter-normalisasi&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Analisis Visual: Sinyal Pasien vs Tipikal Pola Prediksi CNN&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/448b93454c8ab22ebce780cfd3ab88ddaf4c904ee1a439a102090d5348c1e374.png" src="_images/448b93454c8ab22ebce780cfd3ab88ddaf4c904ee1a439a102090d5348c1e374.png" />
</div>
</div>
<p>link streamlit: <em><a class="reference external" href="https://ecg-heartbeat-classification-koli7stxuwvvunofjzpfbj.streamlit.app/">https://ecg-heartbeat-classification-koli7stxuwvvunofjzpfbj.streamlit.app/</a></em></p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="EkstraksiAudio.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Ekstraksi Fitur Audio dengan 3 Domain</strong></p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bussines-understanding"><strong>Bussines Understanding</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tujuan-analisis"><strong>Tujuan Analisis</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-data-eda"><strong>Understanding Data (EDA)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-dataset"><strong>Load Dataset</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ukuran-dataset"><strong>Ukuran Dataset</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cek-missing-value"><strong>Cek Missing Value</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distribusi-kelas-imbalance"><strong>Distribusi Kelas (Imbalance)</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-contoh-sinyal-per-kelas"><strong>Plot Contoh Sinyal per Kelas</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-processing"><strong>Pre Processing</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#normalisasi-data-menggunakan-min-max-scalling"><strong>Normalisasi Data menggunakan Min-Max Scalling</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#split-data-dan-menyeimbangkan-data-dengan-smote"><strong>Split Data dan Menyeimbangkan Data dengan SMOTE</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelling-data"><strong>Modelling Data</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forest"><strong>Random Forest</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-cnn"><strong>1D CNN</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluasi"><strong>Evaluasi</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#table-comparison"><strong>Table Comparison</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#confusion-matrix"><strong>Confusion Matrix</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisasi-prediksi-sinyal"><strong>Visualisasi Prediksi Sinyal</strong></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>